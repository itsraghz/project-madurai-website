<!DOCTYPE html>
<html lang="en">

<head>


  <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, viewport-fit=cover"
    />
    <base href="/">
    <title>Project Madurai School</title>

    
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/images/apple-touch-icon.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/images/favicon-16x16.png"
    />
    <link rel="manifest" href="/images/site.webmanifest" />

    
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />


    

    <link rel="stylesheet" href="/css/style.css"/>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css"
      integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ="
      crossorigin="anonymous"
    />



  


</head>

<body>
  <main class="container mt-5 w-100 h-100">
    <nav class="navbar navbar-expand-md navbar-light bg-white py-0 fixed-top">
  <div class="container-fluid border-bottom border-top-1 shadow-sm bg-body">
    <a class="navbar-brand lh-1" href="/">
      
      
        <span class="text-primary"><strong>Project Madurai</strong></span><br>
        <p class="text-muted text-end w-100 p-0 mb-0"><small class="dropdown-toggle">தமிழ்</small></p>
      </a>

      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsExampleDefault"
      aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="navbarsExampleDefault">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" href="/books/javascript">Javascript</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="/books/c">C</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="/practices/java">Java</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" href="/posts">Blog</a>
        </li>
      </ul>
      <form class="d-flex">
        <input class="form-control" type="search" placeholder="Search" aria-label="Search">
      </form>
      <ul class="navbar-nav secured">
        <li class="nav-item btn pe-0">
          <a class="nav-link" href="/chat"><i class="far fa-comment-dots fa-2x"></i></a>
        </li>
        <li class="nav-item pe-0 dropdown">
          
          <div class="btn-group bg-light">
            <a class="btn btn-toggle pe-0" data-bs-toggle="dropdown" aria-expanded="false">
              <div class="d-flex bd-highlight">
                <div class="w-100 bd-highlight text-end">
                  <h6 class="text-muted fw-bold">தமிழ்ச் சங்கம்</h6>
                  <small class="text-muted">திருவள்ளுவர் கழகம்</small>
               </div>
                <div class="flex-shrink-1 bd-highlight">
                  <img src="http://ssl.gstatic.com/accounts/ui/avatar_2x.png" class="img-circle img-thumbnail avatar"
                style="vertical-align: middle;border-radius: 50%; width: 3rem; margin-right: 10px;" alt="avatar">
                </div>
                
                
              </div>
            </a>
            <ul class="dropdown-menu" aria-labelledby="dropdown03">
              <li><a class="dropdown-item" href="javascript://">Profile</a></li>
              <li><a class="dropdown-item" href="/campuses/tamil-sangam">Campus</a></li>
              <li><a class="dropdown-item logout" href="javascript://">Logout</a></li>
            </ul>
          </div>
        </li>
      </ul>
    </div>
  </div>
</nav>
    <div class="row py-5 w-100 h-100">
       

  <nav class="navbar border-1 border-bottom">
  <div class="row w-100">
    <div class="col-4">
      
    </div>
    <div class="col-4 mb-2 text-center">
      <a class="text-dark"
        href="/books/javascript/promises-async-await">Promises, async/await</a>
    </div>
    <div class="col-4 d-flex justify-content-end align-items-center">
      <a href="/books/javascript/promises-async-await/promise-basics">Promise</a>
    </div>
  </div>
</nav>

<main id="content" class="pt-3"><h2 id="introduction-callbacks"><strong>Introduction: callbacks</strong></h2>
<blockquote>
<p>⚠️ <strong>We use browser methods in examples here</strong></p>
<p>To demonstrate the use of callbacks, promises and other abstract concepts, we’ll be using some browser methods: specifically, loading scripts and performing simple document manipulations.</p>
<p>If you’re not familiar with these methods, and their usage in the examples is confusing, you may want to read a few chapters from the <a href="">next part</a> of the tutorial.</p>
<p>Although, we’ll try to make things clear anyway. There won’t be anything really complex browser-wise.</p>
</blockquote>
<p>Many functions are provided by JavaScript host environments that allow you to schedule asynchronous actions. In other words, actions that we initiate now, but they finish later.</p>
<p>For instance, one such function is the <code>setTimeout</code> function.</p>
<p>There are other real-world examples of asynchronous actions, e.g. loading scripts and modules (we’ll cover them in later chapters).</p>
<p>Take a look at the function <code>loadScript(src)</code>, that loads a script with the given <code>src</code>:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">loadScript</span>(<span style="color:#a6e22e">src</span>) {
    <span style="color:#75715e">// creates a &lt;script&gt; tag and append it to the page
</span><span style="color:#75715e"></span>    <span style="color:#75715e">// this causes the script with given src to start loading and run when complete
</span><span style="color:#75715e"></span>    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">script</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;script&#39;</span>);
    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">src</span>;
    document.<span style="color:#a6e22e">head</span>.<span style="color:#a6e22e">append</span>(<span style="color:#a6e22e">script</span>);
    }

</code></pre></div><p>It appends to the document the new, dynamically created, tag <code>&lt;script src=&quot;…&quot;&gt;</code> with given <code>src</code>. The browser automatically starts loading it and executes when complete.</p>
<p>We can use this function like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#75715e">// load and execute the script at the given path
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script.js&#39;</span>);

</code></pre></div><p>The script is executed “asynchronously”, as it starts loading now, but runs later, when the function has already finished.</p>
<p>If there’s any code below <code>loadScript(…)</code>, it doesn’t wait until the script loading finishes.</p>
<pre><code class="language-javscript" data-lang="javscript">
    loadScript('/my/script.js');
    // the code below loadScript
    // doesn't wait for the script loading to finish
    // ...

</code></pre><p>Let’s say we need to use the new script as soon as it loads. It declares new functions, and we want to run them.</p>
<p>But if we do that immediately after the <code>loadScript(…)</code> call, that wouldn’t work:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script.js&#39;</span>); <span style="color:#75715e">// the script has &#34;function newFunction() {…}&#34;
</span><span style="color:#75715e"></span>
    <span style="color:#a6e22e">newFunction</span>(); <span style="color:#75715e">// no such function!
</span><span style="color:#75715e"></span>
</code></pre></div><p>Naturally, the browser probably didn’t have time to load the script. As of now, the <code>loadScrip</code>t function doesn’t provide a way to track the load completion. The script loads and eventually runs, that’s all. But we’d like to know when it happens, to use new functions and variables from that script.</p>
<p>Let’s add a <code>callback</code> function as a second argument to <code>loadScript</code> that should execute when the script loads:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">loadScript</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">callback</span>) {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">script</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;script&#39;</span>);
    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">src</span>;

    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">onload</span> <span style="color:#f92672">=</span> () =&gt; <span style="color:#a6e22e">callback</span>(<span style="color:#a6e22e">script</span>);

    document.<span style="color:#a6e22e">head</span>.<span style="color:#a6e22e">append</span>(<span style="color:#a6e22e">script</span>);
    }

</code></pre></div><p>Now if we want to call new functions from the script, we should write that in the callback:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script.js&#39;</span>, <span style="color:#66d9ef">function</span>() {
    <span style="color:#75715e">// the callback runs after the script is loaded
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">newFunction</span>(); <span style="color:#75715e">// so now it works
</span><span style="color:#75715e"></span>    ...
    });

</code></pre></div><p>That’s the idea: the second argument is a function (usually anonymous) that runs when the action is completed.</p>
<p>Here’s a runnable example with a real script:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">loadScript</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">callback</span>) {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">script</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;script&#39;</span>);
    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">src</span>;
    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">onload</span> <span style="color:#f92672">=</span> () =&gt; <span style="color:#a6e22e">callback</span>(<span style="color:#a6e22e">script</span>);
    document.<span style="color:#a6e22e">head</span>.<span style="color:#a6e22e">append</span>(<span style="color:#a6e22e">script</span>);
    }

    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;https://cdnjs.cloudflare.com/ajax/libs/lodash.js/3.2.0/lodash.js&#39;</span>, <span style="color:#a6e22e">script</span> =&gt; {
    <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">`Cool, the script </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">src</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> is loaded`</span>);
    <span style="color:#a6e22e">alert</span>( <span style="color:#ae81ff">_</span> ); <span style="color:#75715e">// function declared in the loaded script
</span><span style="color:#75715e"></span>    });

</code></pre></div><p>That’s called a “callback-based” style of asynchronous programming. A function that does something asynchronously should provide a<code>callback</code>argument where we put the function to run after it’s complete.</p>
<p>Here we did it in <code>loadScript</code>, but of course it’s a general approach.</p>
<h2 id="callback-in-callback"><strong><a href="">Callback in callback</a></strong></h2>
<p>How can we load two scripts sequentially: the first one, and then the second one after it?</p>
<p>The natural solution would be to put the second <code>loadScript</code> call inside the callback, like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">script</span>) {

    <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">`Cool, the </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">src</span><span style="color:#e6db74">}</span><span style="color:#e6db74"> is loaded, let&#39;s load one more`</span>);

    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script2.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">script</span>) {
        <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">`Cool, the second script is loaded`</span>);
    });

    });

</code></pre></div><p>After the outer <code>loadScript</code> is complete, the callback initiates the inner one.</p>
<p>What if we want one more script…?</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">script</span>) {

    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script2.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">script</span>) {

        <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script3.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">script</span>) {
        <span style="color:#75715e">// ...continue after all scripts are loaded
</span><span style="color:#75715e"></span>        });

    });

    });

</code></pre></div><p>So, every new action is inside a callback. That’s fine for few actions, but not good for many, so we’ll see other variants soon.</p>
<p><strong><a href="">Handling errors</a></strong></p>
<p>In the above examples we didn’t consider errors. What if the script loading fails? Our callback should be able to react on that.</p>
<p>Here’s an improved version of<code> loadScript</code> that tracks loading errors:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">loadScript</span>(<span style="color:#a6e22e">src</span>, <span style="color:#a6e22e">callback</span>) {
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">script</span> <span style="color:#f92672">=</span> document.<span style="color:#a6e22e">createElement</span>(<span style="color:#e6db74">&#39;script&#39;</span>);
    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">src</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">src</span>;

    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">onload</span> <span style="color:#f92672">=</span> () =&gt; <span style="color:#a6e22e">callback</span>(<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">script</span>);
    <span style="color:#a6e22e">script</span>.<span style="color:#a6e22e">onerror</span> <span style="color:#f92672">=</span> () =&gt; <span style="color:#a6e22e">callback</span>(<span style="color:#66d9ef">new</span> Error(<span style="color:#e6db74">`Script load error for </span><span style="color:#e6db74">${</span><span style="color:#a6e22e">src</span><span style="color:#e6db74">}</span><span style="color:#e6db74">`</span>));

    document.<span style="color:#a6e22e">head</span>.<span style="color:#a6e22e">append</span>(<span style="color:#a6e22e">script</span>);
    }

    <span style="color:#e6db74">```
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    It calls `</span><span style="color:#a6e22e">callback</span>(<span style="color:#66d9ef">null</span>, <span style="color:#a6e22e">script</span>)<span style="color:#e6db74">` for successful load and `</span><span style="color:#a6e22e">callback</span>(<span style="color:#a6e22e">error</span>)<span style="color:#e6db74">` otherwise.
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    The usage:
</span><span style="color:#e6db74">
</span><span style="color:#e6db74">    ```</span><span style="color:#a6e22e">javascript</span>

    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;/my/script.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">script</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) {
        <span style="color:#75715e">// handle error
</span><span style="color:#75715e"></span>    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">// script loaded successfully
</span><span style="color:#75715e"></span>    }
    });

</code></pre></div><p>Once again, the recipe that we used for <code>loadScript</code> is actually quite common. It’s called the “error-first callback” style.</p>
<p>The convention is:</p>
<ol>
<li>
<p>The first argument of the callback is reserved for an error if it occurs. Then callback(err) is called.</p>
</li>
<li>
<p>The second argument (and the next ones if needed) are for the successful result. Then callback(null, result1, result2…) is called.</p>
</li>
</ol>
<p>So the single <code>callback</code> function is used both for reporting errors and passing back results.</p>
<h3 id="pyramid-of-doom"><strong><a href="">Pyramid of Doom</a></strong></h3>
<p>From the first look, it’s a viable way of asynchronous coding. And indeed it is. For one or maybe two nested calls it looks fine.</p>
<p>But for multiple asynchronous actions that follow one after another we’ll have code like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;1.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">script</span>) {

    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) {
        <span style="color:#a6e22e">handleError</span>(<span style="color:#a6e22e">error</span>);
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;2.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">script</span>) {
        <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) {
            <span style="color:#a6e22e">handleError</span>(<span style="color:#a6e22e">error</span>);
        } <span style="color:#66d9ef">else</span> {
            <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;3.js&#39;</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">script</span>) {
            <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) {
                <span style="color:#a6e22e">handleError</span>(<span style="color:#a6e22e">error</span>);
            } <span style="color:#66d9ef">else</span> {
                <span style="color:#75715e">// ...continue after all scripts are loaded (*)
</span><span style="color:#75715e"></span>            }
            });

        }
        });
    }
    });

</code></pre></div><p>In the code above:</p>
<ol>
<li>We load <code>1.js</code>, then if there’s no error.</li>
<li>We load <code>2.js</code>, then if there’s no error.</li>
<li>We load <code>3.js</code>, then if there’s no error – do something else <code>(*)</code>.</li>
</ol>
<p>As calls become more nested, the code becomes deeper and increasingly more difficult to manage, especially if we have real code instead of <code>...</code> that may include more loops, conditional statements and so on.</p>
<p>That’s sometimes called “callback hell” or “pyramid of doom.”</p>
<hr>
<p>img bending</p>
<hr>
<p>The “pyramid” of nested calls grows to the right with every asynchronous action. Soon it spirals out of control.</p>
<p>So this way of coding isn’t very good.</p>
<p>We can try to alleviate the problem by making every action a standalone function, like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">
    <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;1.js&#39;</span>, <span style="color:#a6e22e">step1</span>);

    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">step1</span>(<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">script</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) {
        <span style="color:#a6e22e">handleError</span>(<span style="color:#a6e22e">error</span>);
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;2.js&#39;</span>, <span style="color:#a6e22e">step2</span>);
    }
    }

    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">step2</span>(<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">script</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) {
        <span style="color:#a6e22e">handleError</span>(<span style="color:#a6e22e">error</span>);
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">// ...
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">loadScript</span>(<span style="color:#e6db74">&#39;3.js&#39;</span>, <span style="color:#a6e22e">step3</span>);
    }
    }

    <span style="color:#66d9ef">function</span> <span style="color:#a6e22e">step3</span>(<span style="color:#a6e22e">error</span>, <span style="color:#a6e22e">script</span>) {
    <span style="color:#66d9ef">if</span> (<span style="color:#a6e22e">error</span>) {
        <span style="color:#a6e22e">handleError</span>(<span style="color:#a6e22e">error</span>);
    } <span style="color:#66d9ef">else</span> {
        <span style="color:#75715e">// ...continue after all scripts are loaded (*)
</span><span style="color:#75715e"></span>    }
    }

</code></pre></div><p>See? It does the same, and there’s no deep nesting now because we made every action a separate top-level function.</p>
<p>It works, but the code looks like a torn apart spreadsheet. It’s difficult to read, and you probably noticed that one needs to eye-jump between pieces while reading it. That’s inconvenient, especially if the reader is not familiar with the code and doesn’t know where to eye-jump.</p>
<p>Also, the functions named <code>step*</code> are all of single use, they are created only to avoid the “pyramid of doom.” No one is going to reuse them outside of the action chain. So there’s a bit of namespace cluttering here.</p>
<p>We’d like to have something better.</p>
<p>Luckily, there are other ways to avoid such pyramids. One of the best ways is to use “promises,” described in the next chapter.</p>
</main>


<div class="modal fade" id="noteModel" tabindex="-1" aria-labelledby="noteModelLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="noteModelLabel">Note</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="mb-3">
          <textarea class="form-control" id="noteText" rows="3"></textarea>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>


    </div>
    
  </main>
  
  



<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">Confimation</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          Are you sure you want to delete ?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">No</button>
          <button type="button" class="btn btn-primary">Yes</button>
        </div>
      </div>
    </div>
  </div>

<div aria-live="polite" aria-atomic="true">
  <div class="toast-container position-absolute top-0 start-0 p-5 mt-5" id="toast-container">
    
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.min.js" integrity="sha384-Atwg2Pkwv9vp0ygtn1JAojH0nYbwNJLPhwyoVbhoPwBhjQPR5VtM2+xf0Uwh9KtT" crossorigin="anonymous"></script>
<script type="text/javascript" src="/js/app.js"></script>



  
  
  

<script type="text/javascript" src="/js/chapter.js"></script>


  
</body>

</html>